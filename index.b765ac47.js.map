{"mappings":"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","sources":["src/JS/api.js"],"sourcesContent":["const API_KEY = '671c14eb1babf71c7ecd9b35ab5716a8';\nconst BASE_URL = 'https://api.themoviedb.org/3';\nconst IMG_BASE_URL = 'https://image.tmdb.org/t/p/w500/';\nconst MOVIE_ID = '619930';\n\nconst refs = {\n    cardsArea: document.querySelector('.js-cards'),\n    onloadMore: document.querySelector('.load-more-btn'),\n\n    searchForm: document.querySelector(`.header__form`),\n    clearTextContentInInput: document.querySelector('.js-input'),\n};\nrefs.onloadMore.style.display = 'none';\nlet pageNum = 1;\n\nrenderTrendCardMarkup()\n\nfunction getTrendingMovies() {\n    return fetch(`${BASE_URL}/trending/movie/day?api_key=${API_KEY}&language=ru\n    &page=${pageNum}&include_adult=false`)\n        .then(resp => {\n            if (!resp.ok) {\n                throw new Error(resp.statusText)\n            } return resp.json()\n        })\n        .catch(err => console.log(err));\n};\n\nasync function getGenreNames() {\n  const response = await fetch(`${BASE_URL}/genre/movie/list?api_key=${API_KEY}&language=en-US`);\n  const data = await response.json();\n  const genNames = await data.genres\n  return genNames\n \n}\n\nasync function  renderTrendCardMarkup() {\nconst genres = await getGenreNames()\ngetTrendingMovies()\n    .then(data => data.results)\n    .then(cards => cards.map(card => { \n    const { genre_ids, poster_path, title, vote_average, release_date, id } = card;\n    let movieGenres = []; \n    for (const genre of genres) {\n    if (genre_ids.includes(genre.id)) {\n            movieGenres.push(genre.name)\n        }\n    if (movieGenres.length > 3) {\n        movieGenres = [...movieGenres.slice(0, 2), '...Other'];\n        }\n        }   \n          \n        const cardMarkup = `<li class='js-card' data-id=\"${id}\">\n     <button type=\"button\" class='js-on-card'>\n     <img src=\"${IMG_BASE_URL}${poster_path}\" alt=\"\" class='js-card-img'>\n     </button>\n     <div class='js-movie-descr'>\n     <p class='js-movie-title'>${title.toUpperCase()}</p>\n     <div class='js-movie-genres'>\n     <p>${movieGenres} | ${release_date.slice(0, 4)}</p>\n     <span class='js-movie-reiting'>${String(vote_average).slice(0, 3)}</span>\n     </div>\n     </div>\n     </li>`\n    \n    refs.cardsArea.insertAdjacentHTML('beforeend', cardMarkup)\n    }))\n    .catch(err => console.log(err));   \n}\n\nfunction getSearchMovies() {\n    return fetch(`${BASE_URL}/search/movie?api_key=${API_KEY}&language=ru\n\n    &page=${pageNum}&query=${searchQuery}&include_adult=false`)\n\n    .then(resp => {\n            if (!resp.ok) {\n                throw new Error(resp.statusText)\n            } return resp.json()\n        })\n    .catch (err => console.log(err));\n}\n\n\nrefs.searchForm.addEventListener(`submit`, onSearch);\n\n\nlet searchQuery = ``;\nlet page = 1;\n\nasync function onSearch(evt){\n    evt.preventDefault();\n    searchQuery = evt.currentTarget.elements.searchQuery.value;\n    page = 1;\n    refs.cardsArea.innerHTML = '';\n    console.log(searchQuery);\n    if (!searchQuery){\n        // Notiflix.Notify.failure(`Please, enter your request`);\n        alert('Please, enter your request');\n        return;\n    }\n    refs.clearTextContentInInput.value = '';\n    creatMarkup()\n  }\n\n async function creatMarkup(){\n     const genres = await getGenreNames();\n     getSearchMovies().then(data => data.results)\n    .then(cards => cards.map(card => { \n    const { genre_ids, poster_path, title, vote_average, release_date, id } = card;\n    let movieGenres = []; \n    for (const genre of genres) {\n    if (genre_ids.includes(genre.id)) {\n            movieGenres.push(genre.name)\n        }\n    if (movieGenres.length > 3) {\n        movieGenres = [...movieGenres.slice(0, 2), '...Other'];\n        }\n        }   \n          \n        const cardMarkup = `<li class='js-card' data-id=\"${id}\">\n     <button type=\"button\" class='js-on-card'>\n     <img src=\"${IMG_BASE_URL}${poster_path}\" alt=\"\" class='js-card-img'>\n     </button>\n     <div class='js-movie-descr'>\n     <p class='js-movie-title'>${title.toUpperCase()}</p>\n     <div class='js-movie-genres'>\n     <p>${movieGenres} | ${release_date.slice(0, 4)}</p>\n     <span class='js-movie-reiting'>${String(vote_average).slice(0, 3)}</span>\n     </div>\n     </div>\n     </li>`\n    \n    refs.cardsArea.insertAdjacentHTML('beforeend', cardMarkup)\n    }))\n    .catch(err => console.log(err));\n }\n\n\n\n\nfunction getMovieDetails() {\n    return fetch(`${BASE_URL}/movie/${MOVIE_ID}?api_key=${API_KEY}`)\n    .then(resp => {\n            if (!resp.ok) {\n                throw new Error(resp.statusText)\n            } return resp.json()\n    })\n    .catch(err => console.log(err));\n};\n\ngetMovieDetails()\n    .then(data => data)\n    .catch(err => console.log(err));\n\nfunction getMovieVideos() {\n    return fetch(`${BASE_URL}/movie/619930/videos?api_key=${API_KEY}`)\n        .then(resp => {\n            if (!resp.ok) {\n                throw new Error(resp.statusText)\n            } return resp.json()\n        })\n        .catch(err => console.log(err));\n}\n\ngetMovieVideos()\n    .then(data => data)\n    .catch(err => console.log(err));\n\n\n\nrefs.onloadMore.addEventListener('click', onLoadMoreBtn)\nsetTimeout(() => {\n       refs.onloadMore.style.display = 'block' \n    }, 2000);\nfunction onLoadMoreBtn() {\n    \n    pageNum += 1;\n    creatMarkup();\n    renderTrendCardMarkup()\n}"],"names":["$d637584d1bf81fd1$var$refs","cardsArea","document","querySelector","onloadMore","searchForm","clearTextContentInInput","style","display","$d637584d1bf81fd1$var$pageNum","async","$d637584d1bf81fd1$var$getGenreNames","response","fetch","data","json","genres","$d637584d1bf81fd1$var$renderTrendCardMarkup","then","resp","ok","Error","statusText","catch","err","console","log","results","cards","map","card","genre_ids","poster_path","title","vote_average","release_date","id","movieGenres","genre","includes","push","name","length","slice","cardMarkup","toUpperCase","String","insertAdjacentHTML","addEventListener","evt","preventDefault","$d637584d1bf81fd1$var$searchQuery","currentTarget","elements","searchQuery","value","$d637584d1bf81fd1$var$page","innerHTML","alert","$d637584d1bf81fd1$var$creatMarkup","setTimeout"],"version":3,"file":"index.b765ac47.js.map"}